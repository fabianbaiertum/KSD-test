# KSD-test
The code file KSD_test.py implements our proposed composite goodness of fit test, which is based on Kernel Stein Discrepancy(KSD).
It follows the algorithm 1 in our paper:  URL ...
We also did a simukation study, comparing the test to the Wildbootstrap KSD-based test by Key et. al. 
For the alternative hypothesis, we compared it to two Maximum Mean Discrepancy based tests, one also proposed by Key et. al see (https://jmlr.org/papers/volume26/24-0276/24-0276.pdf), 
while the other was proposed by Brueck, Ferminan and Min (BFM) in their paper (https://www.jmlr.org/papers/volume26/23-1199/23-1199.pdf). The BFM test is available in R, written by Florian Brueck (https://github.com/florianbrueck/MMD_tests_for_model_selection/blob/main/BFM-TEST.R) and was later implemented in Python using GPU by Fabian Baier (https://github.com/fabianbaiertum/BFM-test).

Our KSD test is implemented using JAX, to make use of GPU, as those tests would be infeasible to run on CPU. 
For the estimation of the different theta's and the wildbootstrap based MMD and KSD tests, we are using the code of Key et. al github link ... 



We use the Gaussian kernel k(x,y)= exp(- (x-y)^2/ 2* l^2) with bandwidth l.
## Plot specifics under null hypothesis (runs=500, B=200)
We calibrated our model to l= sqrt(d) * 0.2, so c=0.2 was close to optimal, found via grid search on additional data.
The tests are under the null that the sample comes from a multivariate Gaussian distribution and we compare the wild bootstrap test of Key et al with our test. 


## Plot specifics under alternative hypothesis (runs=300, B=200 for both bootstrap methods)
For testing the power of our test, we compare it to the BFM MMD-based test and the two parametric tests proposed by Key et al, one based on MMD and one based on KSD. We found the bandwidth l= sqrt(d) appropriate for the dimensions we wanted to test since we are testing with a sample generated by a Gaussian Mixture Model and the 

## Further code/runtime improvements
As this test will most likely be used for large n and dimensions d, probabilistic techniques or approximations should be used. Also, GPU memory management could be improved when using multiple H100 graphic cards. Also, the optimal bandwidth parameter is sensitive to variance.



